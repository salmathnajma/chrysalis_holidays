!function(a,t,r,s){t.wp=t.wp||{},t.wp.gdrts=t.wp.gdrts||{},t.wp.gdrts.transfer={status:{active:!1,stop:!1,total:0,current:0,pages:0,step:500,settings:{}},init:function(){wp.gdrts.transfer.status.step=gdrts_data.step_transfer,a(".d4p-content-left .button-primary").click(function(t){t.preventDefault(),wp.gdrts.transfer.status.active?wp.gdrts.transfer.transfer.stop():(wp.gdrts.transfer.transfer.settings(),wp.gdrts.transfer.transfer.start())})},transfer:{settings:function(){var s={plugin:a(".gdrts-tr-plugin").val(),data:[]};a(".gdrts-tr-check:checked").each(function(){var t=a(this).val(),r={rating:t};a(".gdrts-tr-checked-"+t).each(function(){r[a(this).attr("name")]=a(this).val()}),s.data.push(r)}),wp.gdrts.transfer.status.settings=s},start:function(){wp.gdrts.transfer.status.active=!0,a(".d4p-panel-buttons .button-primary").val(gdrts_data.button_stop),a("#gdrts-remotecall-intro").slideUp(),a("#gdrts-remotecall-process").slideDown(),wp.gdrts.transfer.transfer._call({operation:"start",settings:wp.gdrts.transfer.status.settings},wp.gdrts.transfer.transfer.callback_start)},stop:function(){wp.gdrts.transfer.status.stop=!0,a(".d4p-panel-buttons .button-primary").attr("disabled",!0)},callback_start:function(t){wp.gdrts.transfer.status.total=t.objects,wp.gdrts.transfer.status.pages=Math.ceil(t.objects/wp.gdrts.transfer.status.step),wp.gdrts.transfer.transfer._write(t.message),wp.gdrts.transfer.transfer.run()},callback_stop:function(t){wp.gdrts.transfer.status.active=!1,wp.gdrts.transfer.transfer._write(t.message)},callback_process:function(t){wp.gdrts.transfer.status.stop?wp.gdrts.transfer.transfer._call({operation:"break"},wp.gdrts.transfer.transfer.callback_stop):(wp.gdrts.transfer.status.current++,wp.gdrts.transfer.transfer._write(t.message),wp.gdrts.transfer.status.current<wp.gdrts.transfer.status.pages?wp.gdrts.transfer.transfer.run():(wp.gdrts.transfer.transfer.stop(),wp.gdrts.transfer.transfer._call({operation:"stop"},wp.gdrts.transfer.transfer.callback_stop)))},run:function(){wp.gdrts.transfer.transfer._call({operation:"run",total:wp.gdrts.transfer.status.total,current:wp.gdrts.transfer.status.current,step:wp.gdrts.transfer.status.step,settings:wp.gdrts.transfer.status.settings},wp.gdrts.transfer.transfer.callback_process)},_write:function(t){a("#gdrts-remotecall-progress pre").prepend(t+"\r\n")},_call:function(t,r){a.ajax({url:ajaxurl+"?action=gdrts_transfer_process&_ajax_nonce="+gdrts_data.nonce,timeout:0,type:"post",dataType:"json",data:t,success:r})}}},wp.gdrts.transfer.init()}(jQuery,window,document);